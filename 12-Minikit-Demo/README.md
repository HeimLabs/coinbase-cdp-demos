# CDP MiniKit Demo - Farcaster Mini App Showcase

A comprehensive MiniKit demonstration showcasing Coinbase Developer Platform (CDP) features within a TBA and Farcaster mini app. This project demonstrates Base Accounts (Smart Wallets), gas-sponsored transactions, onchain identity, notifications, and more - all packaged in a mobile-optimized mini app experience.

## üåü Features

- **Complete CDP Showcase**: Demonstrates all major CDP features in one mini app
- **Base Account Integration**: Seamless Smart Wallet connection and management
- **Gas-Sponsored Transactions**: Free POA NFT minting via Coinbase Paymaster
- **Onchain Identity**: ENS name resolution, avatars, and badges
- **Farcaster Frame Integration**: Native frame experience with account association
- **Background Notifications**: Redis-backed notification system with webhooks
- **Modern Mobile UI**: Pixel-perfect mobile design with glassmorphism effects
- **Safe Area Support**: Proper handling of device safe areas and notches
- **Real-time Updates**: Live transaction monitoring and status updates

## üõ†Ô∏è Tech Stack

- **MiniKit**: Farcaster's mini app framework for embedded experiences
- **OnchainKit**: Coinbase's React components for onchain apps
- **Next.js 15**: React framework with App Router
- **Farcaster Frame SDK**: Native frame integration and account association
- **Redis (Upstash)**: Background notifications and webhook handling
- **Wagmi**: React hooks for Ethereum interactions
- **Viem**: TypeScript interface for Ethereum
- **Tailwind CSS**: Utility-first CSS framework with custom theming

## üìã Prerequisites

- Node.js (v18 or later)
- npm, yarn, pnpm, or bun package manager
- Farcaster account for testing the mini app
- Redis instance (Upstash recommended) for notifications
- Base Sepolia testnet access

## üöÄ Quick Start

### 1. Clone and Install

```bash
# Clone the repository
git clone https://github.com/HeimLabs/coinbase-cdp-demos.git
cd 12-Minikit-Demo

# Install dependencies
npm install
# or
yarn install
# or
pnpm install
# or
bun install
```

### 2. Environment Setup

Create a `.env.local` file in the root directory:

```bash
# Copy the example environment file
cp .env.example .env.local
```

Configure the required environment variables:

```env
# Shared/OnchainKit variables
NEXT_PUBLIC_ONCHAINKIT_PROJECT_NAME=CDP-MiniKit-Demo
NEXT_PUBLIC_URL=http://localhost:3000
NEXT_PUBLIC_ICON_URL=http://localhost:3000/icon.png
NEXT_PUBLIC_ONCHAINKIT_API_KEY=your_onchainkit_api_key

# Frame metadata (generated by create-onchain --manifest)
FARCASTER_HEADER=your_farcaster_header
FARCASTER_PAYLOAD=your_farcaster_payload
FARCASTER_SIGNATURE=your_farcaster_signature
NEXT_PUBLIC_APP_ICON=http://localhost:3000/icon.png
NEXT_PUBLIC_APP_SUBTITLE=CDP Features Showcase
NEXT_PUBLIC_APP_DESCRIPTION=Experience the full power of CDP in a mini app
NEXT_PUBLIC_APP_SPLASH_IMAGE=http://localhost:3000/splash.png
NEXT_PUBLIC_SPLASH_BACKGROUND_COLOR=#000000
NEXT_PUBLIC_APP_PRIMARY_CATEGORY=social
NEXT_PUBLIC_APP_HERO_IMAGE=http://localhost:3000/hero.png
NEXT_PUBLIC_APP_TAGLINE=Built with Coinbase Developer Platform
NEXT_PUBLIC_APP_OG_TITLE=CDP MiniKit Demo
NEXT_PUBLIC_APP_OG_DESCRIPTION=Comprehensive CDP features in a Farcaster mini app
NEXT_PUBLIC_APP_OG_IMAGE=http://localhost:3000/screenshot.png

# Redis config (for notifications)
REDIS_URL=your_redis_url
REDIS_TOKEN=your_redis_token
```

### 3. Generate Frame Manifest (Optional)

To enable Farcaster account association and notifications:

```bash
# Generate frame manifest with account association
npx create-onchain --manifest
```

This will update your environment variables with the proper Farcaster headers for account association.

### 4. Start the Development Server

```bash
npm run dev
# or
yarn dev
# or  
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) to view the mini app.

## üéØ Demo Features Walkthrough

### 1. Base Account Connection
- **Smart Wallet Integration**: Connect with Coinbase Smart Wallet for seamless onchain experience
- **Multi-Wallet Support**: Support for MetaMask, WalletConnect, and other popular wallets
- **Automatic Detection**: Different UI based on wallet type and capabilities

### 2. Onchain Identity Display  
- **ENS Integration**: Automatic ENS name resolution and display
- **Avatar & Badges**: Display onchain avatars and reputation badges
- **Address Display**: Formatted address display with copy functionality

### 3. Gas-Sponsored Transaction
- **Free POA NFT**: Mint a Proof of Attendance NFT with zero gas fees
- **CDP Paymaster**: Powered by Coinbase Paymaster for frictionless UX
- **Real-time Status**: Live transaction monitoring and success feedback

### 4. Farcaster Integration
- **Save to Account**: Add the mini app to your Farcaster account
- **Context Awareness**: Access to Farcaster ID and user context
- **Frame Optimization**: Mobile-optimized for in-frame experience

### 5. Notification System
- **Background Processing**: Redis-backed webhook system
- **Account Association**: Enable notifications through account linking
- **Push Notifications**: Ready-to-use notification infrastructure

## üèóÔ∏è Technical Architecture

### MiniKit Integration

The app leverages MiniKit's full capability stack:

```typescript
// MiniKit Provider Setup
<MiniKitProvider>
  <OnchainKitProvider>
    <WagmiProvider>
      <QueryClientProvider>
        {children}
      </QueryClientProvider>
    </WagmiProvider>
  </OnchainKitProvider>
</MiniKitProvider>
```

### Core Components

1. **DemoComponents.tsx**: Main showcase component with all CDP features
2. **Frame Configuration**: Proper frame metadata and account association
3. **Notification System**: Background webhook processing
4. **Safe Area Handling**: Mobile-optimized layout with device safe areas

### Smart Contract Integration

The demo interacts with a POA (Proof of Attendance) contract:

```typescript
// POA Contract Integration
<Transaction
  chainId={baseSepolia.id}
  contracts={[{
    address: "0x696a22e358e861253B7aB7CBa22c3e2667CF9b5B",
    abi: POA_ABI,
    functionName: 'mintAttendance',
    args: [eventId, signature],
  }]}
  isSponsored={true}  // Gas-sponsored via Paymaster
>
```

### Project Structure

```
12-Minikit-Demo/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ notify/route.ts      # Notification endpoint
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ webhook/route.ts     # Webhook handler
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ DemoComponents.tsx   # Main demo showcase
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx                 # Entry point
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx              # Frame metadata & providers
‚îÇ   ‚îú‚îÄ‚îÄ providers.tsx           # MiniKit & OnchainKit setup
‚îÇ   ‚îî‚îÄ‚îÄ theme.css               # Custom CDP theming
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ abi.ts                  # Smart contract ABIs
‚îÇ   ‚îú‚îÄ‚îÄ notification.ts         # Notification utilities
‚îÇ   ‚îú‚îÄ‚îÄ notification-client.ts  # Client-side notification
‚îÇ   ‚îî‚îÄ‚îÄ redis.ts               # Redis configuration
‚îî‚îÄ‚îÄ public/                     # Frame assets & images
```

## üé® UI/UX Features

### Glassmorphism Design
- **Modern Aesthetic**: Frosted glass effects with backdrop blur
- **Gradient Backgrounds**: Beautiful gradients for visual appeal
- **Mobile-First**: Optimized for mobile frame experience

### Responsive Layout
- **Safe Areas**: Proper handling of device notches and safe areas
- **Touch-Friendly**: Large touch targets for mobile interaction
- **Loading States**: Smooth loading animations and transitions

### Theme Customization
Custom CSS variables in `theme.css`:

```css
:root {
  --ock-bg-default: #000000;
  --ock-bg-alternate: #111111;
  --font-family-display: 'Pixelify Sans', monospace;
}
```

## üöÄ Deployment & Distribution

### Farcaster Frame Deployment

1. **Deploy to Vercel/Netlify**: Host your mini app on a public URL
2. **Update Environment Variables**: Set production URLs and keys
3. **Generate Frame Manifest**: Run `npx create-onchain --manifest`
4. **Cast Your Frame**: Share the frame URL in a Farcaster cast
5. **Account Association**: Users can save the frame to their accounts

### Production Considerations

- **Frame Metadata**: Ensure proper OpenGraph and Frame metadata
- **Performance**: Optimize loading times for mobile experience
- **Error Handling**: Graceful error handling for network issues
- **Rate Limiting**: Implement rate limiting for API endpoints

## üí° Use Cases & Applications

- **Event Management**: POA NFT distribution for events and conferences
- **Community Building**: Reward system for community participation
- **Product Demos**: Showcase CDP features to potential developers
- **Educational Content**: Teaching blockchain concepts through interaction
- **Marketing Campaigns**: Engage users with interactive onchain experiences

## üîß Customization Guide

### Adding New Features

1. **New Components**: Add components to `app/components/`
2. **API Routes**: Create new endpoints in `app/api/`
3. **Smart Contracts**: Add ABIs to `lib/abi.ts`
4. **Styling**: Update `theme.css` for custom theming

### Modifying the Demo

```typescript
// Customize the POA contract
const CONTRACT_ADDRESS = "your_contract_address";
const CONTRACT_ABI = [...]; // Your contract ABI

// Update the transaction
<Transaction
  contracts={[{
    address: CONTRACT_ADDRESS,
    abi: CONTRACT_ABI,
    functionName: 'yourFunction',
    args: [customArgs],
  }]}
>
```

## üõ†Ô∏è Development

### Available Scripts

- `npm run dev`: Start development server
- `npm run build`: Build for production  
- `npm run start`: Start production server
- `npm run lint`: Run ESLint for code quality

### Testing Your Frame

1. **Local Testing**: Use ngrok or similar for local frame testing
2. **Frame Validator**: Use Farcaster's frame validator tools
3. **Mobile Testing**: Test on actual mobile devices within Farcaster
4. **Account Association**: Test the save-to-account functionality

## üìñ Additional Resources

- [MiniKit Documentation](https://docs.base.org/builderkits/minikit/overview)
- [OnchainKit Documentation](https://onchainkit.xyz/getting-started)
- [Farcaster Frame SDK](https://docs.farcaster.xyz/reference/frames/spec)
- [CDP Documentation](https://docs.cdp.coinbase.com/)
- [Base Network Documentation](https://docs.base.org/)
- [Upstash Redis Documentation](https://docs.upstash.com/redis)

## üîí Security Notes

- Never commit private keys or sensitive environment variables
- Use testnet for development and testing
- Implement proper rate limiting for production APIs
- Validate all user inputs in API routes
- Use HTTPS for production deployments
- Monitor gas sponsorship usage to prevent abuse

## ü§ù Contributing

Contributions are welcome! To contribute:

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## üìÑ License

This project is licensed under the terms specified in the package.json file.

---

**Disclaimer**: This project is for demonstration purposes. For production use, additional security measures, monitoring, and testing should be implemented. Always test thoroughly on testnets before using mainnet.

---

Built with ‚ù§Ô∏è using [MiniKit](https://docs.base.org/builderkits/minikit/overview) and [OnchainKit](https://onchainkit.xyz/)
